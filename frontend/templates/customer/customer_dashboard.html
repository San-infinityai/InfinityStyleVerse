<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Customer Dashboard | InfinityStyleVerse</title>

  <!-- Bootstrap Styles -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Shared Stylesheet -->
  <link rel="stylesheet" href="../../assets/css/customer_dashboard.css">
</head>
<body>

  <!-- Notification Banner -->
  <div class="notification-bar">
    New styles just dropped! Check your recommendations now.
  </div>

  {% include 'customer/notifications.html' %}

  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" role="navigation" aria-label="Customer Dashboard Navigation">
      <h2>Customer Dashboard</h2>
      <ul>
        <li onclick="showSection('home')">Home</li>
        <li onclick="showSection('styleTwin')">My Style Twin</li>
        <li onclick="showSection('recommendations')">Recommendations</li>
        <li onclick="showSection('feedback')">Feedback</li>
        <li onclick="showSection('settings')">Settings</li>
      </ul>
    </aside>

    <!-- Main Content -->
    <div class="main-content" role="main">
      <!-- Home Section -->
      <div class="content-section active" id="home">
        <h3>Filter Products</h3>
       <div class="filter-buttons">
  <button data-filter="all">All</button>
  <button data-filter="casual">Casual</button>
  <button data-filter="formal">Formal</button>
  <button data-filter="ethnic">Ethnic</button>
  <button data-filter="party">Party</button>
</div>

<div class="product-grid" id="productGrid">
  <!-- Products will be inserted here by JavaScript -->
</div>

      <!-- Style Twin Section -->
      <div class="content-section" id="styleTwin">
        <h3>My Style Twin</h3>
        <p>Your personalized fashion profile will appear here.</p>
      </div>

      <!-- Recommendations Section -->
      <div class="content-section" id="recommendations">
        {% include 'customer/recommendations.html' %}
      </div>

      <!-- Feedback Section -->
      <div class="content-section" id="feedback">
        {% include 'customer/feedback_form.html' %}
      </div>

      <!-- Settings Section -->
      <div class="content-section" id="settings">
        <h3>Settings</h3>
        <p>Update your preferences and profile here.</p>
      </div>
    </div>
  </div>


  <script src="../../scripts/customer_dashboard.js"></script>
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const productGrid = document.getElementById('productGrid');
    const filterButtons = document.querySelectorAll('.filter-buttons button');
    let products = []; // to store fetched products

    // Function to create product card HTML (adjust as per your design)
    function createProductCard(product) {
      return `
        <div class="product-card" data-category="${product.category.toLowerCase()}">
          <h4>${product.title}</h4>
          <img src="${product.image_url}" alt="${product.title}" />
          <p>Category: ${product.category}</p>
          <p>Price: $${product.price}</p>
          <!-- Add more fields as needed -->
        </div>
      `;
    }

    // Render products to the grid (optionally filtered)
    function renderProducts(filter = 'all') {
      productGrid.innerHTML = '';
      const filteredProducts = filter === 'all'
        ? products
        : products.filter(p => p.category.toLowerCase() === filter);

      if (filteredProducts.length === 0) {
        productGrid.innerHTML = '<p>No products found.</p>';
        return;
      }

      filteredProducts.forEach(product => {
        productGrid.insertAdjacentHTML('beforeend', createProductCard(product));
      });
    }

    // Fetch products from backend API
    async function fetchProducts() {
      try {
        const response = await fetch('/products?limit=100&offset=0');  
        const data = await response.json();
        products = data.products;
        renderProducts(); // Render all initially
      } catch (error) {
        productGrid.innerHTML = '<p>Failed to load products.</p>';
        console.error('Error fetching products:', error);
      }
    }

    // Event listeners for filter buttons
    filterButtons.forEach(button => {
      button.addEventListener('click', () => {
        const filter = button.getAttribute('data-filter');
        renderProducts(filter);
      });
    });

    // Initial fetch
    fetchProducts();
  });
</script>

</body>
</html>
